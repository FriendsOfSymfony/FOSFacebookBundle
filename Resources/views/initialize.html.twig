<div id="fb-root"></div>
{% if not async %}
<script src="http://connect.facebook.net/{{ culture }}/all.js"></script>
{% endif %}
<script>
{% autoescape false %}
{% if async %}
window.fbAsyncInit = function() {
{% endif %}
  FB.init({{ {'appId':appId, 'xfbml':xfbml, 'session':session, 'status':status, 'cookie':cookie, 'logging':logging }|json_encode }});
  FB.Event.subscribe('auth.login', function(response) {
    window.location = '{{ login_url }}';
  });
  FB.Event.subscribe('auth.logout', function(response) {
    window.location = '{{ logout_url }}';
  });
{% if async %}
  {{ fbAsyncInit }}
};

(function() {
  var e = document.createElement('script');
  e.src = document.location.protocol + {{ "//connect.facebook.net/%s/all.js"|format(culture)|json_encode }};
  e.async = true;
  document.getElementById('fb-root').appendChild(e);
}());
{% endif %}
{% endautoescape %}
</script>
